id: ssh-root-password-enabled

info:
  name: SSH Root Password Enabled - Detection
  author: staticnoise
  severity: info
  description: Enabled password authentication on root account increases risk of credential stuffing and may expose the server to bruteforce attacks.
  reference:
    - https://man.openbsd.org/sshd_config
  metadata:
    max-request: 1
  tags: js,detect,ssh,enum,network

javascript:
  - pre-condition: |
      isPortOpen(Host,Port);

    code: |
      var m = require("nuclei/ssh");
      var c = m.SSHClient();
      try {
        c.Connect(Host, Port, "root", "asdf");
      } catch (error) {
        Export(error);
      }

    args:
      Host: "{{Host}}"
      Port: "22"

    matchers:
      - type: dsl
        dsl:
          - 'success == true'
          - 'contains(response, "password") || contains(response, "keyboard-interactive")'
        condition: and
