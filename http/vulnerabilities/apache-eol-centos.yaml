id: apache-eol-centos

info:
  name: Apache EOL CentOS Detection
  author: staticnoise
  severity: info
  description: CentOS has reached EOL, does not receive security updates and is vulnerable to many vulnerabilities.
  metadata:
    max-request: 1
    shodan-query: '"Server: Apache/" "centos"'
    fofa-query: 'header="Server: Apache/" && "centos"'
    zoomeye-query: 'app:"Apache httpd" and banner:"CentOS"'
  tags: tech,apache,centos,eol
  reference:
    - https://endoflife.date/centos
    - https://blog.centos.org/2023/04/end-dates-are-coming-for-centos-stream-8-and-centos-linux-7/

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    extractors:
      - part: header
        type: regex
        group: 1
        regex:
          - 'Apache/([\d.]*) \((centos|CentOS)\)'

    matchers-condition: and
    matchers:
      - type: regex
        part: header
        regex:
          - 'Apache/(\d+\.\d+\.\d+) \((centos|CentOS)\)'
